let c = 0;
let s = 5;
const u = new URLSearchParams(window.location.search);
const si = u.get('session')?.replaceAll(':', '');

const closeWindow = () => {
    $('#sp-wi-9052 .item-image').click();
    c += 1;
    if (c > 2 && s <= 0) {
        window.location.href = 'https://www.youtube.com/watch?v=J7SOfbFzY-E';
    }
};

const SetRole = () => {
    const d = {
        confirm_reauthorize: true,
        reauthorize_profile: 'Final_Role [authenticated]'
    };

    const url = 'https://erfreewifi.com/api/session/' + si + '/reauthorize';
    //var url="https://192.168.20.5/api/session/"+sessionId+"/reauthorize"

    $.ajax({
        type: 'Post',
        url: url,
        data: JSON.stringify(d),
        headers: {
            Authorization: 'Bearer eb8e110bd1a6f6107f7aa2f9bab33649755192a7',
            'Content-Type': 'application/json'
        },
        contentType: 'application/json; charset=utf-8',
        Accept: '*/*',
        success: function (res) {
            console.log('res:', res);
        },
        error: function (error) {
            console.log('error: ', error);
        }
    });
};

const t = setInterval(() => {
    document.querySelector('#counterTwo').textContent = --s;
    s === 3 && SetRole();
    s < 1 && (clearInterval(t), (document.querySelector('#counterTwo').textContent = ' إنهاء '), closeWindow());
}, 1000);
